<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MUYAMBILI - Plateforme de Lecture</title>
    <meta name="google-site-verification" content="beie_Kl8KbKOUKTOClkAvA6jQi-GR22CUvpICwKghzI" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #d4b896;
            --secondary: #e8d5c4;
            --accent: #a78a6f;
            --light: #f8f4f0;
            --dark: #5d4037;
            --gray: #8d6e63;
            --success: #7cb342;
            --warning: #f9a825;
            --danger: #e57373;
            --shadow: 0 4px 6px rgba(93, 64, 55, 0.1);
            --transition: all 0.3s ease;
        }

        [data-theme="dark"] {
            --primary: #8b7355;
            --secondary: #6d5d4c;
            --accent: #a78a6f;
            --light: #2d2d2d;
            --dark: #e8e8e8;
            --gray: #a8a8a8;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        body {
            background: linear-gradient(rgba(248, 244, 240, 0.9), rgba(248, 244, 240, 0.9));
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
            color: var(--dark);
            line-height: 1.6;
            transition: var(--transition);
            min-height: 100vh;
            overflow-x: hidden;
        }

        [data-theme="dark"] body {
            background: linear-gradient(rgba(45, 45, 45, 0.9), rgba(45, 45, 45, 0.9));
        }

        /* Splash Screen */
        #splashScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--primary);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }

        .splash-content {
            text-align: center;
            color: var(--dark);
        }

        .splash-logo {
            font-size: 4rem;
            font-weight: bold;
            margin-bottom: 20px;
            animation: fadeInUp 1s ease;
        }

        .splash-loader {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(93, 64, 55, 0.3);
            border-top: 3px solid var(--dark);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .toast {
            background: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            border-left: 4px solid var(--success);
            max-width: 350px;
            word-wrap: break-word;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.error {
            border-left-color: var(--danger);
        }

        .toast.warning {
            border-left-color: var(--warning);
        }

        .toast i {
            font-size: 1.2rem;
            min-width: 24px;
        }

        /* Layout */
        .app-container {
            display: flex;
            min-height: 100vh;
            opacity: 0;
            animation: fadeIn 0.5s ease 0.5s forwards;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        /* Sidebar */
        .sidebar {
            width: 250px;
            background-color: var(--primary);
            color: var(--dark);
            padding: 20px 0;
            transition: var(--transition);
            box-shadow: var(--shadow);
            z-index: 100;
        }

        .logo {
            text-align: center;
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(93, 64, 55, 0.1);
            margin-bottom: 20px;
        }

        .logo h1 {
            font-size: 1.8rem;
            font-weight: 700;
        }

        .logo span {
            color: var(--accent);
        }

        .nav-links {
            list-style: none;
            padding: 0 15px;
        }

        .nav-links li {
            margin-bottom: 10px;
        }

        .nav-links a {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            color: var(--dark);
            text-decoration: none;
            border-radius: 8px;
            transition: var(--transition);
            cursor: pointer;
        }

        .nav-links a:hover, .nav-links a.active {
            background-color: rgba(212, 184, 150, 0.3);
        }

        .nav-links i {
            margin-right: 12px;
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }

        .theme-toggle {
            margin: 20px 15px 0;
            padding: 10px 15px;
            background: rgba(212, 184, 150, 0.3);
            border: none;
            border-radius: 8px;
            color: var(--dark);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: var(--transition);
            width: calc(100% - 30px);
        }

        .theme-toggle:hover {
            background: rgba(212, 184, 150, 0.5);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        /* Header with Search */
        .header {
            margin-bottom: 30px;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--secondary);
        }

        .search-bar {
            flex: 1;
            max-width: 500px;
            position: relative;
        }

        .search-bar input {
            width: 100%;
            padding: 12px 20px;
            border-radius: 30px;
            border: 1px solid var(--secondary);
            font-size: 1rem;
            padding-left: 45px;
            transition: var(--transition);
            background: white;
        }

        .search-bar input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(212, 184, 150, 0.2);
        }

        .search-bar i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        .user-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-actions button {
            background: none;
            border: none;
            color: var(--dark);
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: var(--transition);
        }

        .user-actions button:hover {
            background: var(--secondary);
        }

        .user-avatar {
            position: relative;
        }

        .user-avatar .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
        }

        .user-avatar .avatar:hover {
            transform: scale(1.05);
        }

        /* Modales d'authentification */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .auth-modal {
            background: var(--light);
            width: 90%;
            max-width: 400px;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }

        .modal-overlay.active .auth-modal {
            transform: translateY(0);
        }

        .auth-header {
            background: var(--primary);
            padding: 25px;
            text-align: center;
            color: var(--dark);
        }

        .auth-header h2 {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }

        .auth-tabs {
            display: flex;
            background: var(--secondary);
        }

        .auth-tab {
            flex: 1;
            padding: 15px;
            border: none;
            background: none;
            color: var(--gray);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .auth-tab.active {
            color: var(--dark);
            background: var(--light);
        }

        .auth-form {
            padding: 30px;
            display: none;
        }

        .auth-form.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--dark);
            font-weight: 600;
        }

        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--secondary);
            border-radius: 8px;
            font-size: 1rem;
            transition: var(--transition);
            background: white;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(212, 184, 150, 0.2);
        }

        .auth-btn {
            width: 100%;
            padding: 14px;
            background: var(--primary);
            color: var(--dark);
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 10px;
            font-size: 1rem;
        }

        .auth-btn:hover {
            background: var(--accent);
            transform: translateY(-2px);
        }

        .auth-error {
            color: var(--danger);
            font-size: 0.9rem;
            margin-top: 10px;
            text-align: center;
            display: none;
        }

        .auth-error.show {
            display: block;
        }

        .auth-footer {
            text-align: center;
            padding: 15px;
            color: var(--gray);
            font-size: 0.9rem;
            border-top: 1px solid var(--secondary);
        }

        .auth-footer a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
        }

        .auth-footer a:hover {
            text-decoration: underline;
        }

        /* Menu utilisateur */
        .user-menu {
            position: absolute;
            top: 50px;
            right: 0;
            background: white;
            min-width: 200px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            display: none;
            z-index: 1000;
            overflow: hidden;
        }

        .user-menu.active {
            display: block;
        }

        .user-info {
            padding: 15px;
            background: var(--primary);
            color: var(--dark);
            border-bottom: 1px solid var(--secondary);
        }

        .user-info strong {
            display: block;
            margin-bottom: 5px;
        }

        .user-info small {
            color: var(--gray);
            font-size: 0.8rem;
        }

        .user-menu-item {
            display: block;
            padding: 12px 15px;
            color: var(--dark);
            text-decoration: none;
            transition: var(--transition);
            border-bottom: 1px solid var(--secondary);
        }

        .user-menu-item:last-child {
            border-bottom: none;
        }

        .user-menu-item:hover {
            background: var(--light);
        }

        .user-menu-item i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        /* Hero Carousel */
        .hero-carousel {
            position: relative;
            height: 500px;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: var(--shadow);
            margin-bottom: 40px;
        }

        .hero-slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 1s ease;
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: center;
            padding: 0 60px;
        }

        .hero-slide.active {
            opacity: 1;
        }

        .hero-content {
            max-width: 50%;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .hero-content h2 {
            font-size: 3rem;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .hero-content p {
            font-size: 1.2rem;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .carousel-control {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.9);
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            transition: var(--transition);
            color: var(--dark);
        }

        .carousel-control:hover {
            background: white;
            transform: translateY(-50%) scale(1.1);
        }

        .carousel-control.prev {
            left: 20px;
        }

        .carousel-control.next {
            right: 20px;
        }

        .carousel-indicators {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
        }

        .indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: var(--transition);
        }

        .indicator.active {
            background: white;
            transform: scale(1.2);
        }

        /* Content Grid */
        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 25px;
            margin-bottom: 50px;
        }

        .item-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
            border: 1px solid var(--secondary);
            position: relative;
        }

        .item-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 25px rgba(93, 64, 55, 0.15);
        }

        .item-card img {
            width: 100%;
            height: 280px;
            object-fit: cover;
        }

        .card-content {
            padding: 20px;
        }

        .card-content h3 {
            margin-bottom: 8px;
            font-size: 1.2rem;
            color: var(--dark);
        }

        .card-content p {
            color: var(--gray);
            font-size: 0.95rem;
            margin-bottom: 12px;
        }

        .genre {
            color: var(--accent) !important;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .views-badge {
            background: var(--light);
            color: var(--accent);
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .favorite-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            color: var(--gray);
        }

        .favorite-btn:hover {
            background: white;
            transform: scale(1.1);
        }

        .favorite-btn.active {
            color: #e74c3c;
        }

        .rating {
            display: flex;
            gap: 2px;
            margin-top: 8px;
        }

        .rating i {
            color: var(--gray);
            cursor: pointer;
            transition: var(--transition);
        }

        .rating i.active {
            color: #f39c12;
        }

        /* Pages */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Section Title */
        .section-title {
            margin: 40px 0 25px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .section-title h2 {
            font-size: 2rem;
            color: var(--dark);
        }

        .view-all {
            color: var(--accent);
            text-decoration: none;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .view-all:hover {
            color: var(--dark);
        }

        /* Page de description */
        .book-detail {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 40px;
            margin-bottom: 40px;
        }

        .desc-cover {
            width: 100%;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(93, 64, 55, 0.2);
        }

        .book-info h1 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--dark);
        }

        .book-meta {
            display: flex;
            gap: 25px;
            margin-bottom: 25px;
            color: var(--gray);
            font-size: 1.1rem;
        }

        .book-description {
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 30px;
            color: var(--dark);
        }

        .book-actions {
            display: flex;
            gap: 15px;
            margin: 30px 0;
        }

        .btn {
            padding: 14px 28px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 10px;
            font-size: 1rem;
        }

        .btn-primary {
            background-color: var(--primary);
            color: var(--dark);
        }

        .btn-primary:hover {
            background-color: var(--accent);
            color: white;
            transform: translateY(-2px);
        }

        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background-color: var(--primary);
            color: var(--dark);
            transform: translateY(-2px);
        }

        .chapters-section {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-top: 30px;
        }

        .chapter-btn {
            padding: 18px 20px;
            border: 2px solid var(--secondary);
            border-radius: 8px;
            background: white;
            width: 100%;
            text-align: left;
            margin-bottom: 12px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chapter-btn:hover {
            background: var(--light);
            border-color: var(--primary);
            transform: translateX(5px);
        }

        .chapter-locked {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .chapter-locked:hover {
            transform: none;
            background: white;
            border-color: var(--secondary);
        }

        .lock-icon {
            color: var(--gray);
            margin-left: 10px;
        }

        /* LECTEUR PDF OPTIMISÉ */
        .reading-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--secondary);
        }

        .reading-header h2 {
            color: var(--dark);
            font-size: 1.8rem;
        }

        .pdf-viewer-container {
            background: white;
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 25px;
            margin-bottom: 25px;
            position: relative;
        }

        .pdf-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding: 20px;
            background: var(--light);
            border-radius: 8px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .pdf-nav-buttons {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .page-info {
            font-weight: 600;
            color: var(--accent);
            font-size: 1.1rem;
            min-width: 140px;
            text-align: center;
        }

        /* Conteneur PDF optimisé */
        #pdfViewer {
            min-height: 600px;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #f5f5f5;
            border-radius: 8px;
            border: 2px solid var(--secondary);
            overflow: auto;
            position: relative;
        }

        /* Canvas haute qualité */
        #pdfCanvas {
            display: block;
            max-width: 100%;
            height: auto;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            background: white;
            image-rendering: crisp-edges;
            image-rendering: -webkit-optimize-contrast;
        }

        .reading-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        /* États de chargement */
        .pdf-loading {
            text-align: center;
            padding: 60px;
            color: var(--gray);
            width: 100%;
        }

        .pdf-progress {
            width: 80%;
            max-width: 300px;
            height: 6px;
            background: var(--secondary);
            border-radius: 3px;
            margin: 20px auto;
            overflow: hidden;
        }

        .pdf-progress-bar {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 3px;
        }

        .pdf-error {
            text-align: center;
            padding: 60px;
            color: var(--danger);
            background: #fdeded;
            border-radius: 12px;
            border: 1px solid var(--danger);
            width: 90%;
            max-width: 500px;
            margin: 0 auto;
        }

        /* Contact Page */
        .contact-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-bottom: 40px;
        }

        .contact-info {
            background: white;
            padding: 35px;
            border-radius: 12px;
            box-shadow: var(--shadow);
        }

        .contact-info h3 {
            margin-bottom: 25px;
            color: var(--dark);
            font-size: 1.5rem;
        }

        .info-item {
            display: flex;
            align-items: flex-start;
            gap: 18px;
            margin-bottom: 25px;
        }

        .info-item i {
            color: var(--primary);
            font-size: 1.3rem;
            margin-top: 3px;
        }

        .info-content h4 {
            margin-bottom: 8px;
            color: var(--dark);
        }

        .info-content p {
            color: var(--gray);
            line-height: 1.6;
        }

        .contact-form {
            background: white;
            padding: 35px;
            border-radius: 12px;
            box-shadow: var(--shadow);
        }

        /* Bibliothèque */
        .library-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--secondary);
        }

        .library-tab {
            padding: 12px 24px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            color: var(--gray);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
        }

        .library-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .library-tab:hover {
            color: var(--dark);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .history-item {
            padding: 20px;
            border-bottom: 1px solid var(--secondary);
            background: white;
            margin-bottom: 12px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
        }

        .history-item:hover {
            transform: translateX(5px);
            border-left: 4px solid var(--primary);
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--gray);
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state h3 {
            margin-bottom: 10px;
            color: var(--dark);
        }

        /* Media Queries pour le responsive */
        @media (max-width: 768px) {
            .app-container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                position: fixed;
                bottom: 0;
                top: auto;
                height: auto;
                padding: 10px 0;
                z-index: 100;
            }

            .logo {
                display: none;
            }

            .nav-links {
                display: flex;
                justify-content: space-around;
                padding: 0;
            }

            .nav-links li {
                margin-bottom: 0;
            }

            .nav-links a {
                flex-direction: column;
                padding: 8px 5px;
                font-size: 0.8rem;
                text-align: center;
            }

            .nav-links i {
                margin-right: 0;
                margin-bottom: 5px;
                font-size: 1.2rem;
            }

            .theme-toggle {
                display: none;
            }

            .main-content {
                padding-bottom: 80px;
            }

            .hero-carousel {
                height: 400px;
            }

            .hero-slide {
                padding: 0 20px;
            }

            .hero-content {
                max-width: 100%;
                text-align: center;
            }

            .hero-content h2 {
                font-size: 2rem;
            }

            .content-grid {
                grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
                gap: 15px;
            }

            .book-detail {
                grid-template-columns: 1fr;
                gap: 25px;
            }

            .auth-modal {
                width: 95%;
            }

            .contact-container {
                grid-template-columns: 1fr;
            }

            .pdf-controls {
                flex-direction: column;
                gap: 15px;
            }

            .pdf-nav-buttons {
                justify-content: center;
            }

            #pdfViewer {
                min-height: 400px;
            }
        }

        @media (min-width: 769px) {
            .mobile-only {
                display: none;
            }
        }
    </style>
    
    <!-- Protection contre l'inspection du code -->
    <script>
        // Empêcher l'accès au code source
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
        });
        
        document.addEventListener('keydown', function(e) {
            // Bloquer F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U
            if (e.keyCode === 123 || 
                (e.ctrlKey && e.shiftKey && e.keyCode === 73) || 
                (e.ctrlKey && e.shiftKey && e.keyCode === 74) || 
                (e.ctrlKey && e.keyCode === 85)) {
                e.preventDefault();
                return false;
            }
        });
    </script>
</head>
<body>
    <!-- Splash Screen -->
    <div id="splashScreen">
        <div class="splash-content">
            <div class="splash-logo">MUYAMBILI</div>
            <div class="splash-loader"></div>
        </div>
    </div>

    <!-- Modal d'authentification -->
    <div class="modal-overlay" id="authModal">
        <div class="auth-modal">
            <div class="auth-header">
                <h2>MUYAMBILI</h2>
                <p>Plateforme de lecture en ligne</p>
            </div>
            
            <div class="auth-tabs">
                <button class="auth-tab active" data-tab="login">Connexion</button>
                <button class="auth-tab" data-tab="register">Inscription</button>
            </div>
            
            <form id="loginForm" class="auth-form active">
                <div class="form-group">
                    <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" placeholder="votre@email.com" required>
                </div>
                
                <div class="form-group">
                    <label for="loginPassword">Mot de passe</label>
                    <input type="password" id="loginPassword" placeholder="Votre mot de passe" required>
                </div>
                
                <div class="auth-error" id="loginError"></div>
                
                <button type="submit" class="auth-btn">
                    <i class="fas fa-sign-in-alt"></i> Se connecter
                </button>
                
                <div class="auth-footer">
                    <p>Pas encore de compte ? <a href="#" onclick="switchAuthTab('register')">S'inscrire</a></p>
                </div>
            </form>
            
            <form id="registerForm" class="auth-form">
                <div class="form-group">
                    <label for="registerName">Nom d'utilisateur</label>
                    <input type="text" id="registerName" placeholder="Choisissez un pseudonyme" required>
                </div>
                
                <div class="form-group">
                    <label for="registerEmail">Email</label>
                    <input type="email" id="registerEmail" placeholder="votre@email.com" required>
                </div>
                
                <div class="form-group">
                    <label for="registerPassword">Mot de passe</label>
                    <input type="password" id="registerPassword" placeholder="Minimum 6 caractères" required>
                </div>
                
                <div class="form-group">
                    <label for="confirmPassword">Confirmer le mot de passe</label>
                    <input type="password" id="confirmPassword" placeholder="Répétez le mot de passe" required>
                </div>
                
                <div class="auth-error" id="registerError"></div>
                
                <button type="submit" class="auth-btn">
                    <i class="fas fa-user-plus"></i> Créer un compte
                </button>
                
                <div class="auth-footer">
                    <p>Déjà un compte ? <a href="#" onclick="switchAuthTab('login')">Se connecter</a></p>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <div class="app-container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="logo">
                <h1>MUY<span>AMBILI</span></h1>
            </div>
            <ul class="nav-links">
                <li><a href="#" class="nav-link active" data-page="homePage"><i class="fas fa-home"></i> <span>Accueil</span></a></li>
                <li><a href="#" class="nav-link" data-page="booksPage"><i class="fas fa-book"></i> <span>Romans</span></a></li>
                <li><a href="#" class="nav-link" data-page="mangaPage"><i class="fas fa-images"></i> <span>Manga</span></a></li>
                <li><a href="#" class="nav-link" data-page="articlesPage"><i class="fas fa-newspaper"></i> <span>Articles</span></a></li>
                <li><a href="#" class="nav-link" data-page="libraryPage"><i class="fas fa-heart"></i> <span>Favoris</span></a></li>
                <li><a href="#" class="nav-link" data-page="contactPage"><i class="fas fa-envelope"></i> <span>Contact</span></a></li>
            </ul>
            <button class="theme-toggle" id="themeToggle">
                <i class="fas fa-moon"></i>
                <span>Mode sombre</span>
            </button>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Header with Search -->
            <header class="header">
                <div class="header-top">
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" id="searchInput" placeholder="Rechercher...">
                    </div>
                    <div class="user-actions">
                        <button id="favoritesBtn" title="Mes favoris">
                            <i class="fas fa-heart"></i>
                        </button>
                        <button id="themeToggleMobile" title="Changer le thème">
                            <i class="fas fa-palette"></i>
                        </button>
                        <div class="user-avatar">
                            <div class="avatar" id="userAvatar" onclick="toggleUserMenu()">V</div>
                            <div class="user-menu" id="userMenu">
                                <div id="userMenuContent"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Hero Carousel -->
                <div class="hero-carousel">
                    <div class="hero-slide active" style="background-image: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), url('assets/images/plume.png')">
                        <div class="hero-content">
                            <h2>Plumes Brûlées</h2>
                            <p>Les plus belles citations d'amour viennent de ceux qui ne l'ont jamais connu.</p>
                            <button class="btn btn-primary" onclick="openDescription('b1')">
                                <i class="fas fa-book-open"></i> Lire maintenant
                            </button>
                        </div>
                    </div>
                    <div class="hero-slide" style="background-image: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), url('https://picsum.photos/1200/600?random=2')">
                        <div class="hero-content">
                            <h2>À venir</h2>
                            <p>Découvrez bientôt de nouveaux contenus exclusifs.</p>
                        </div>
                    </div>
                    <div class="hero-slide" style="background-image: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), url('https://picsum.photos/1200/600?random=3')">
                        <div class="hero-content">
                            <h2>Prochainement</h2>
                            <p>Restez connectés pour plus de lectures passionnantes.</p>
                        </div>
                    </div>
                    
                    <button class="carousel-control prev"><i class="fas fa-chevron-left"></i></button>
                    <button class="carousel-control next"><i class="fas fa-chevron-right"></i></button>
                    
                    <div class="carousel-indicators">
                        <div class="indicator active" data-slide="0"></div>
                        <div class="indicator" data-slide="1"></div>
                        <div class="indicator" data-slide="2"></div>
                    </div>
                </div>
            </header>

            <!-- Home Page -->
            <section id="homePage" class="page active">
                <div class="section-title">
                    <h2>Romans en Vedette</h2>
                    <a href="#" class="view-all" data-page="booksPage">Voir Tout</a>
                </div>
                <div class="content-grid" id="booksList"></div>

                <div class="section-title">
                    <h2>Mangas Populaires</h2>
                    <a href="#" class="view-all" data-page="mangaPage">Voir Tout</a>
                </div>
                <div class="content-grid" id="mangaList"></div>

                <div class="section-title">
                    <h2>Articles Récents</h2>
                    <a href="#" class="view-all" data-page="articlesPage">Voir Tout</a>
                </div>
                <div class="content-grid" id="articlesList"></div>
            </section>

            <!-- Books Page -->
            <section id="booksPage" class="page">
                <div class="section-title">
                    <h2>Tous les Romans</h2>
                </div>
                <div class="content-grid" id="booksPageList"></div>
            </section>

            <!-- Manga Page -->
            <section id="mangaPage" class="page">
                <div class="section-title">
                    <h2>Tous les Mangas</h2>
                </div>
                <div class="content-grid" id="mangaPageList"></div>
            </section>

            <!-- Articles Page -->
            <section id="articlesPage" class="page">
                <div class="section-title">
                    <h2>Tous les Articles</h2>
                </div>
                <div class="content-grid" id="articlesPageList"></div>
            </section>

            <!-- Library Page -->
            <section id="libraryPage" class="page">
                <div class="section-title">
                    <h2>Ma Bibliothèque</h2>
                </div>
                <div class="library-content" id="libraryContent"></div>
            </section>

            <!-- Description Page -->
            <section id="descriptionPage" class="page">
                <div class="book-detail">
                    <div class="book-cover-container">
                        <img id="descCover" class="desc-cover" src="" alt="">
                    </div>
                    <div id="descriptionContent"></div>
                </div>
            </section>

            <!-- Reader Page -->
            <section id="readerPage" class="page">
                <div class="reading-header">
                    <h2 id="readerTitle">Lecture</h2>
                    <button class="btn btn-outline" onclick="showPage('descriptionPage')">
                        <i class="fas fa-arrow-left"></i> Retour
                    </button>
                </div>
                
                <div class="pdf-viewer-container">
                    <div class="pdf-controls">
                        <div class="pdf-nav-buttons">
                            <button class="btn btn-outline" onclick="prevPage()">
                                <i class="fas fa-chevron-left"></i> Précédent
                            </button>
                            <span class="page-info">
                                Page <span id="pageNum">1</span> sur <span id="pageCount">0</span>
                            </span>
                            <button class="btn btn-outline" onclick="nextPage()">
                                Suivant <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                        <div class="pdf-zoom-controls">
                            <button class="btn btn-outline" onclick="zoomOut()" title="Zoom arrière">
                                <i class="fas fa-search-minus"></i>
                            </button>
                            <button class="btn btn-outline" onclick="resetZoom()" title="Zoom normal (100%)">
                                <i class="fas fa-search"></i> 100%
                            </button>
                            <button class="btn btn-outline" onclick="zoomIn()" title="Zoom avant">
                                <i class="fas fa-search-plus"></i>
                            </button>
                            <button class="btn btn-outline" onclick="fitToWidth()" title="Adapter à la largeur">
                                <i class="fas fa-arrows-alt-h"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div id="pdfViewer">
                        <div class="pdf-loading" id="pdfLoading">
                            <i class="fas fa-spinner fa-spin"></i>
                            <p>Chargement du PDF...</p>
                            <div class="pdf-progress">
                                <div class="pdf-progress-bar" id="pdfProgressBar"></div>
                            </div>
                            <p id="pdfLoadingText">Initialisation...</p>
                        </div>
                    </div>
                </div>

                <div class="reading-controls">
                    <button class="btn btn-outline" onclick="showPage('descriptionPage')">
                        <i class="fas fa-arrow-left"></i> Retour au livre
                    </button>
                    <div>
                        <button class="btn btn-outline" onclick="downloadPDF()" title="Télécharger le PDF">
                            <i class="fas fa-download"></i> Télécharger
                        </button>
                    </div>
                </div>
            </section>

            <!-- Contact Page -->
            <section id="contactPage" class="page">
                <div class="section-title">
                    <h2>Contactez-nous</h2>
                </div>
                <div class="contact-container">
                    <div class="contact-info">
                        <h3>Informations de contact</h3>
                        <div class="info-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <div class="info-content">
                                <h4>Adresse</h4>
                                <p>Amissa, Akanda, Gabon</p>
                            </div>
                        </div>
                        <div class="info-item">
                            <i class="fas fa-phone"></i>
                            <div class="info-content">
                                <h4>Téléphone</h4>
                                <p>+241 74 67 58 14</p>
                            </div>
                        </div>
                        <div class="info-item">
                            <i class="fas fa-envelope"></i>
                            <div class="info-content">
                                <h4>Email</h4>
                                <p>contact@muyambili.com</p>
                            </div>
                        </div>
                    </div>
                    <div class="contact-form">
                        <h3>Envoyez-nous un message</h3>
                        <form id="contactForm">
                            <div class="form-group">
                                <label for="name">Nom complet</label>
                                <input type="text" id="name" name="name" required>
                            </div>
                            <div class="form-group">
                                <label for="email">Email</label>
                                <input type="email" id="email" name="email" required>
                            </div>
                            <div class="form-group">
                                <label for="message">Message</label>
                                <textarea id="message" name="message" rows="5" required></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-paper-plane"></i> Envoyer
                            </button>
                        </form>
                    </div>
                </div>
            </section>

            <!-- Search Results Page -->
            <section id="searchPage" class="page">
                <div class="section-title">
                    <h2>Résultats de Recherche</h2>
                </div>
                <div id="searchResults" class="content-grid"></div>
            </section>
        </main>
    </div>

    <script>
        // Configuration PDF.js optimisée
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';

        // Variables PDF
        let currentPdf = null;
        let currentPageNum = 1;
        let currentScale = 1.2; // Échelle augmentée pour meilleure lisibilité

        // =============================
        // GESTION DE L'AUTHENTIFICATION
        // =============================
        
        let currentUser = null;
        let users = JSON.parse(localStorage.getItem('muyambili_users') || '[]');
        const AUTH_KEY = 'muyambili_current_user';
        
        function loadCurrentUser() {
            const savedUser = localStorage.getItem(AUTH_KEY);
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    updateUserInterface();
                } catch (e) {
                    localStorage.removeItem(AUTH_KEY);
                }
            }
        }
        
        function saveUsers() {
            localStorage.setItem('muyambili_users', JSON.stringify(users));
        }
        
        function register(username, email, password) {
            if (users.find(u => u.email === email)) {
                return { success: false, message: 'Cet email est déjà utilisé' };
            }
            if (users.find(u => u.username === username)) {
                return { success: false, message: 'Ce nom d\'utilisateur est déjà pris' };
            }
            if (password.length < 6) {
                return { success: false, message: 'Le mot de passe doit faire au moins 6 caractères' };
            }
            
            const newUser = {
                id: Date.now().toString(),
                username: username,
                email: email,
                password: btoa(password),
                createdAt: new Date().toISOString(),
                favorites: [],
                ratings: {},
                history: [],
                chapterViews: {} // Stockage des vues par chapitre
            };
            
            users.push(newUser);
            saveUsers();
            
            return login(email, password);
        }
        
        function login(email, password) {
            const user = users.find(u => u.email === email);
            
            if (!user) {
                return { success: false, message: 'Email incorrect' };
            }
            if (user.password !== btoa(password)) {
                return { success: false, message: 'Mot de passe incorrect' };
            }
            
            currentUser = { ...user };
            delete currentUser.password;
            localStorage.setItem(AUTH_KEY, JSON.stringify(currentUser));
            
            updateUserInterface();
            return { success: true, message: 'Connexion réussie !' };
        }
        
        function logout() {
            currentUser = null;
            localStorage.removeItem(AUTH_KEY);
            updateUserInterface();
            showToast('Déconnexion réussie', 'success');
            showPage('homePage');
        }
        
        function updateUserInterface() {
            const userAvatar = document.getElementById('userAvatar');
            const userMenuContent = document.getElementById('userMenuContent');
            
            if (currentUser) {
                userAvatar.textContent = currentUser.username.charAt(0).toUpperCase();
                userAvatar.style.backgroundColor = getColorFromName(currentUser.username);
                
                userMenuContent.innerHTML = `
                    <div class="user-info">
                        <strong>${currentUser.username}</strong>
                        <small>${currentUser.email}</small>
                    </div>
                    <a href="#" class="user-menu-item" onclick="showPage('libraryPage'); toggleUserMenu()">
                        <i class="fas fa-heart"></i> Mes favoris
                    </a>
                    <a href="#" class="user-menu-item" onclick="logout(); toggleUserMenu()">
                        <i class="fas fa-sign-out-alt"></i> Déconnexion
                    </a>
                `;
            } else {
                userAvatar.textContent = 'V';
                userAvatar.style.backgroundColor = 'var(--accent)';
                
                userMenuContent.innerHTML = `
                    <div class="user-info">
                        <strong>Visiteur</strong>
                        <small>Non connecté</small>
                    </div>
                    <a href="#" class="user-menu-item" onclick="showAuthModal('login'); toggleUserMenu()">
                        <i class="fas fa-sign-in-alt"></i> Connexion
                    </a>
                    <a href="#" class="user-menu-item" onclick="showAuthModal('register'); toggleUserMenu()">
                        <i class="fas fa-user-plus"></i> Inscription
                    </a>
                `;
            }
            
            updateProtectedContent();
        }
        
        function getColorFromName(name) {
            const colors = ['#FF6B6B', '#4ECDC4', '#FFD166', '#06D6A0', '#118AB2', '#EF476F', '#7209B7', '#3A86FF'];
            const hash = name.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
            return colors[hash % colors.length];
        }
        
        // =============================
        // GESTION DES VUES DE CHAPITRES
        // =============================
        
        function getChapterViewCount(itemId, chapterIndex) {
            if (!currentUser || !currentUser.chapterViews) return 0;
            
            const key = `${itemId}_chapter_${chapterIndex}`;
            return currentUser.chapterViews[key] || 0;
        }
        
        function incrementChapterView(itemId, chapterIndex) {
            if (!currentUser) return false;
            
            if (!currentUser.chapterViews) {
                currentUser.chapterViews = {};
            }
            
            const key = `${itemId}_chapter_${chapterIndex}`;
            
            // Un utilisateur ne fait qu'une vue par chapitre
            if (!currentUser.chapterViews[key]) {
                currentUser.chapterViews[key] = 1;
                localStorage.setItem(AUTH_KEY, JSON.stringify(currentUser));
                return true;
            }
            
            return false;
        }
        
        function getTotalChapterViews(itemId) {
            if (!currentUser || !currentUser.chapterViews) return 0;
            
            let total = 0;
            for (let key in currentUser.chapterViews) {
                if (key.startsWith(`${itemId}_chapter_`)) {
                    total += currentUser.chapterViews[key];
                }
            }
            return total;
        }

        // =============================
        // GESTION DES MODALES
        // =============================
        
        function showAuthModal(tab = 'login') {
            const modal = document.getElementById('authModal');
            modal.classList.add('active');
            switchAuthTab(tab);
        }
        
        function hideAuthModal() {
            const modal = document.getElementById('authModal');
            modal.classList.remove('active');
            document.getElementById('loginForm').reset();
            document.getElementById('registerForm').reset();
            hideErrors();
        }
        
        function switchAuthTab(tab) {
            document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.auth-form').forEach(f => f.classList.remove('active'));
            
            document.querySelector(`.auth-tab[data-tab="${tab}"]`).classList.add('active');
            document.getElementById(`${tab}Form`).classList.add('active');
        }
        
        function showError(elementId, message) {
            const errorDiv = document.getElementById(elementId);
            errorDiv.textContent = message;
            errorDiv.classList.add('show');
        }
        
        function hideErrors() {
            document.querySelectorAll('.auth-error').forEach(e => {
                e.classList.remove('show');
                e.textContent = '';
            });
        }
        
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            hideErrors();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            const result = login(email, password);
            if (result.success) {
                hideAuthModal();
                showToast(result.message, 'success');
            } else {
                showError('loginError', result.message);
            }
        });
        
        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            hideErrors();
            
            const username = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (password !== confirmPassword) {
                showError('registerError', 'Les mots de passe ne correspondent pas');
                return;
            }
            
            const result = register(username, email, password);
            if (result.success) {
                hideAuthModal();
                showToast(result.message, 'success');
            } else {
                showError('registerError', result.message);
            }
        });
        
        document.getElementById('authModal').addEventListener('click', function(e) {
            if (e.target === this) {
                hideAuthModal();
            }
        });
        
        // =============================
        // GESTION DU MENU UTILISATEUR
        // =============================
        
        function toggleUserMenu() {
            const menu = document.getElementById('userMenu');
            menu.classList.toggle('active');
        }
        
        document.addEventListener('click', function(e) {
            const menu = document.getElementById('userMenu');
            const avatar = document.getElementById('userAvatar');
            
            if (menu && avatar && !avatar.contains(e.target) && !menu.contains(e.target)) {
                menu.classList.remove('active');
            }
        });
        
        // =============================
        // LECTEUR PDF HAUTE QUALITÉ
        // =============================
        
        async function openChapter(itemId, chapterIndex) {
            if (!currentUser) {
                showAuthModal('login');
                showToast('Connectez-vous pour lire', 'warning');
                return;
            }
            
            const item = data.books.find(b => b.id === itemId);
            
            if (!item || !item.chapters[chapterIndex]) return;
            
            // Incrémenter la vue du chapitre (une seule fois)
            const wasNewView = incrementChapterView(itemId, chapterIndex);
            
            // Ajouter à l'historique
            currentUser.history.unshift({
                itemId: itemId,
                chapterIndex: chapterIndex,
                title: `${item.title} - ${item.chapters[chapterIndex].title}`,
                timestamp: new Date().toISOString()
            });
            
            if (currentUser.history.length > 50) {
                currentUser.history = currentUser.history.slice(0, 50);
            }
            
            localStorage.setItem(AUTH_KEY, JSON.stringify(currentUser));
            
            document.getElementById('readerTitle').textContent = `${item.title} - ${item.chapters[chapterIndex].title}`;
            
            // Afficher immédiatement la page de lecture
            showPage('readerPage');
            
            // Charger le PDF en arrière-plan
            setTimeout(() => loadPDF(item.chapters[chapterIndex].pdf), 100);
        }
        
        async function loadPDF(url) {
            try {
                // Nettoyer l'état précédent
                if (currentPdf) {
                    try {
                        currentPdf.destroy();
                    } catch (e) {}
                    currentPdf = null;
                }
                
                showToast('Chargement du PDF en cours...', 'success');
                
                // Configuration pour qualité optimale
                const loadingTask = pdfjsLib.getDocument({
                    url: url,
                    cMapUrl: 'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.4.120/cmaps/',
                    cMapPacked: true,
                    disableAutoFetch: false,
                    disableStream: false,
                    disableRange: false,
                    enableXfa: false
                });
                
                currentPdf = await loadingTask.promise;
                
                document.getElementById('pageCount').textContent = currentPdf.numPages;
                currentPageNum = 1;
                
                // Rendu de la première page
                await renderPage(currentPageNum);
                
                showToast('PDF chargé avec succès', 'success');
                
            } catch (error) {
                console.error('Erreur de chargement PDF:', error);
                document.getElementById('pdfViewer').innerHTML = `
                    <div class="pdf-error">
                        <i class="fas fa-exclamation-triangle"></i>
                        <p>Erreur de chargement du PDF</p>
                        <p style="font-size: 0.9rem; margin-top: 10px;">Veuillez vérifier que le fichier PDF existe à l'adresse: assets/images/plume.pdf</p>
                        <div style="margin-top: 15px;">
                            <button class="btn btn-primary" onclick="showPage('descriptionPage')">
                                <i class="fas fa-arrow-left"></i> Retour
                            </button>
                        </div>
                    </div>
                `;
                showToast('Erreur lors du chargement du PDF', 'error');
            }
        }
        
        async function renderPage(pageNum) {
            if (!currentPdf) return;
            
            try {
                const page = await currentPdf.getPage(pageNum);
                const container = document.getElementById('pdfViewer');
                const containerWidth = container.clientWidth - 80;
                
                // Calcul d'échelle avec qualité optimale
                const viewport = page.getViewport({ scale: 1 });
                let scale = Math.min(currentScale, containerWidth / viewport.width);
                
                // Utiliser le devicePixelRatio pour un rendu net
                const pixelRatio = window.devicePixelRatio || 1;
                scale = scale * pixelRatio;
                
                const scaledViewport = page.getViewport({ scale: scale });
                
                // Création du canvas avec haute qualité
                const canvas = document.createElement('canvas');
                canvas.id = 'pdfCanvas';
                const context = canvas.getContext('2d', { alpha: false });
                
                // Configuration haute qualité
                canvas.height = Math.floor(scaledViewport.height);
                canvas.width = Math.floor(scaledViewport.width);
                canvas.style.height = Math.floor(scaledViewport.height / pixelRatio) + 'px';
                canvas.style.width = Math.floor(scaledViewport.width / pixelRatio) + 'px';
                
                // Amélioration de la qualité de rendu
                context.imageSmoothingEnabled = true;
                context.imageSmoothingQuality = 'high';
                
                const renderContext = {
                    canvasContext: context,
                    viewport: scaledViewport,
                    enableWebGL: true, // WebGL activé pour meilleure performance
                    intent: 'display',
                    renderInteractiveForms: false
                };
                
                // Masquer l'indicateur de chargement
                const loadingElement = document.getElementById('pdfLoading');
                if (loadingElement) {
                    loadingElement.style.display = 'none';
                }
                
                await page.render(renderContext).promise;
                
                // Affichage final
                container.innerHTML = '';
                container.appendChild(canvas);
                
                document.getElementById('pageNum').textContent = pageNum;
                
            } catch (error) {
                console.error('Erreur de rendu de page:', error);
                document.getElementById('pdfViewer').innerHTML = `
                    <div class="pdf-error">
                        <i class="fas fa-exclamation-triangle"></i>
                        <p>Erreur d'affichage de la page</p>
                        <button class="btn btn-outline" onclick="renderPage(${pageNum})" style="margin-top: 15px;">
                            <i class="fas fa-redo"></i> Réessayer
                        </button>
                    </div>
                `;
            }
        }
        
        function nextPage() {
            if (currentPdf && currentPageNum < currentPdf.numPages) {
                currentPageNum++;
                renderPage(currentPageNum);
            }
        }
        
        function prevPage() {
            if (currentPdf && currentPageNum > 1) {
                currentPageNum--;
                renderPage(currentPageNum);
            }
        }
        
        function zoomIn() {
            if (currentScale < 3.0) {
                currentScale += 0.2;
                currentScale = Math.round(currentScale * 10) / 10;
                renderPage(currentPageNum);
                showToast(`Zoom: ${Math.round(currentScale * 100)}%`);
            }
        }
        
        function zoomOut() {
            if (currentScale > 0.5) {
                currentScale -= 0.2;
                currentScale = Math.round(currentScale * 10) / 10;
                renderPage(currentPageNum);
                showToast(`Zoom: ${Math.round(currentScale * 100)}%`);
            }
        }
        
        function resetZoom() {
            currentScale = 1.2; // 120% par défaut pour meilleure lisibilité
            renderPage(currentPageNum);
            showToast('Zoom réinitialisé à 120%');
        }
        
        function fitToWidth() {
            if (!currentPdf) return;
            
            const container = document.getElementById('pdfViewer');
            const containerWidth = container.clientWidth - 80;
            
            currentPdf.getPage(currentPageNum).then(page => {
                const viewport = page.getViewport({ scale: 1 });
                currentScale = containerWidth / viewport.width;
                currentScale = Math.round(currentScale * 10) / 10;
                renderPage(currentPageNum);
                showToast(`Adapté à la largeur: ${Math.round(currentScale * 100)}%`);
            });
        }
        
        function downloadPDF() {
            const item = data.books.find(b => b.id === 'b1');
            if (item && item.chapters && item.chapters[0]) {
                const link = document.createElement('a');
                link.href = item.chapters[0].pdf;
                link.download = 'plumes-brulees.pdf';
                link.target = '_blank';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                showToast('Téléchargement du PDF démarré', 'success');
            }
        }
        
        // =============================
        // DONNÉES ET AFFICHAGE
        // =============================
        
        const data = {
            books: [
                {
                    id: "b1",
                    title: "Plumes Brûlées",
                    author: "Dr DOOM",
                    genre: "Poésie",
                    cover: "assets/images/plume.png",
                    description: "Alfred de Musset, Louis Aragon, Albert Camus, Victor Hugo, de grands amoureux de l'amour mais qui ne l'ont jamais connu. Dans leurs écrits, ils présentaient l'amour comme quelque chose de magique entre deux personnes, mais leurs vies...",
                    chapters: [
                        { title: "Poème", pdf: "assets/images/plume.pdf" }
                    ]
                },
                {
                    id: "b2",
                    title: "Ètrange sens",
                    author: "Dr DOOM",
                    genre: "Poésie",
                    cover: "assets/images/DOOM.png",
                    description: "Les sentiments amoureux sont la réaction que DOOM n'a jamais pu comprendre.",
                    chapters: [
                        { title: "Poème", pdf: "assets/images/M.pdf" }
                    ]
                }
            ],
            mangas: [
                {
                    id: "m1",
                    title: "Bientôt disponible",
                    author: "MUYAMBILI",
                    genre: "À venir",
                    cover: "https://picsum.photos/300/400?random=2",
                    description: "De nouveaux mangas arrivent bientôt sur la plateforme.",
                    chapters: []
                }
            ],
            articles: [
                {
                    id: "a1",
                    title: "À venir",
                    author: "MUYAMBILI",
                    genre: "Information",
                    cover: "https://picsum.photos/300/400?random=3",
                    description: "Des articles passionnants arrivent prochainement.",
                    pdf: ""
                }
            ]
        };
        
        function renderList(containerId, items) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            container.innerHTML = '';
            items.forEach(item => {
                const totalViews = currentUser ? getTotalChapterViews(item.id) : 0;
                const isFavorite = currentUser ? currentUser.favorites.includes(item.id) : false;
                const rating = currentUser ? (currentUser.ratings[item.id] || 0) : 0;
                
                container.innerHTML += `
                    <div class="item-card" onclick="openDescription('${item.id}')">
                        <img src="${item.cover}" alt="${item.title}" loading="lazy">
                        <button class="favorite-btn ${isFavorite ? 'active' : ''}" 
                                onclick="event.stopPropagation(); toggleFavorite('${item.id}')">
                            <i class="fas fa-heart"></i>
                        </button>
                        <div class="card-content">
                            <h3>${item.title}</h3>
                            <p>${item.author}</p>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <p class="genre">${item.genre}</p>
                                <span class="views-badge">${totalViews} vue${totalViews > 1 ? 's' : ''}</span>
                            </div>
                            ${currentUser ? `
                                <div class="rating" onclick="event.stopPropagation()">
                                    ${[1,2,3,4,5].map(star => `
                                        <i class="fas fa-star ${star <= rating ? 'active' : ''}" 
                                           onclick="rateItem('${item.id}', ${star})"></i>
                                    `).join('')}
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `;
            });
        }
        
        function openDescription(itemId) {
            let item = data.books.find(b => b.id === itemId) ||
                       data.mangas.find(m => m.id === itemId) ||
                       data.articles.find(a => a.id === itemId);
            
            if (!item) return;
            
            document.getElementById('descCover').src = item.cover;
            document.getElementById('descCover').alt = item.title;
            
            const totalViews = currentUser ? getTotalChapterViews(item.id) : 0;
            const isFavorite = currentUser ? currentUser.favorites.includes(item.id) : false;
            const rating = currentUser ? (currentUser.ratings[item.id] || 0) : 0;
            
            let chaptersHtml = '';
            if (item.chapters && item.chapters.length > 0) {
                item.chapters.forEach((chapter, index) => {
                    const chapterViews = currentUser ? getChapterViewCount(item.id, index) : 0;
                    const canRead = currentUser ? true : false;
                    
                    chaptersHtml += `
                        <button class="chapter-btn ${canRead ? '' : 'chapter-locked'}" 
                                ${canRead ? `onclick="openChapter('${item.id}', ${index})"` : 'onclick="showAuthModal(\'login\')"'}
                                ${!canRead ? 'title="Connectez-vous pour lire"' : ''}>
                            <span>
                                ${chapter.title}
                                ${!canRead ? '<i class="fas fa-lock lock-icon"></i>' : ''}
                            </span>
                            <span class="chapter-views">${chapterViews} vue${chapterViews > 1 ? 's' : ''}</span>
                        </button>
                    `;
                });
            }
            
            document.getElementById('descriptionContent').innerHTML = `
                <div class="book-info">
                    <div style="display: flex; justify-content: space-between; align-items: start;">
                        <h1>${item.title}</h1>
                        ${currentUser ? `
                            <button class="favorite-btn ${isFavorite ? 'active' : ''}" 
                                    onclick="toggleFavorite('${item.id}')">
                                <i class="fas fa-heart"></i>
                            </button>
                        ` : ''}
                    </div>
                    <div class="book-meta">
                        <span><i class="fas fa-user"></i> ${item.author}</span>
                        <span><i class="fas fa-tag"></i> ${item.genre}</span>
                        <span><i class="fas fa-eye"></i> ${totalViews} vue${totalViews > 1 ? 's' : ''}</span>
                    </div>
                    <div class="book-description">
                        <p>${item.description}</p>
                    </div>
                    ${currentUser ? `
                        <div style="margin: 20px 0;">
                            <div class="rating">
                                <span style="margin-right: 10px; font-weight: 600;">Votre note :</span>
                                ${[1,2,3,4,5].map(star => `
                                    <i class="fas fa-star ${star <= rating ? 'active' : ''}" 
                                       onclick="rateItem('${item.id}', ${star})"></i>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}
                </div>
                ${item.chapters && item.chapters.length > 0 ? `
                    <div class="chapters-section">
                        <h2><i class="fas fa-list-ol"></i> Chapitres (Total: ${totalViews} vue${totalViews > 1 ? 's' : ''})</h2>
                        ${chaptersHtml}
                    </div>
                ` : ''}
            `;
            
            showPage('descriptionPage');
        }
        
        function updateProtectedContent() {
            const libraryContent = document.getElementById('libraryContent');
            if (libraryContent) {
                if (currentUser) {
                    libraryContent.innerHTML = `
                        <div class="library-tabs">
                            <button class="library-tab active" data-tab="favorites" onclick="switchLibraryTab('favorites')">Favoris</button>
                            <button class="library-tab" data-tab="history" onclick="switchLibraryTab('history')">Historique</button>
                        </div>
                        <div id="favoritesTab" class="tab-content active">
                            <div class="content-grid" id="favoritesList"></div>
                        </div>
                        <div id="historyTab" class="tab-content">
                            <div id="historyContent"></div>
                        </div>
                    `;
                    
                    // Afficher les favoris
                    const favoritesList = document.getElementById('favoritesList');
                    if (favoritesList) {
                        const favoriteItems = data.books.filter(item => 
                            currentUser.favorites.includes(item.id)
                        );
                        renderList('favoritesList', favoriteItems);
                    }
                    
                    // Afficher l'historique
                    const historyContent = document.getElementById('historyContent');
                    if (historyContent && currentUser.history) {
                        if (currentUser.history.length === 0) {
                            historyContent.innerHTML = `
                                <div class="empty-state">
                                    <i class="fas fa-history"></i>
                                    <h3>Aucun historique</h3>
                                    <p>Votre historique de lecture apparaîtra ici.</p>
                                </div>
                            `;
                        } else {
                            historyContent.innerHTML = '';
                            currentUser.history.forEach(historyItem => {
                                const item = data.books.find(b => b.id === historyItem.itemId);
                                if (item) {
                                    historyContent.innerHTML += `
                                        <div class="history-item" onclick="openChapter('${historyItem.itemId}', ${historyItem.chapterIndex})">
                                            <h4>${historyItem.title}</h4>
                                            <p>Lu le ${new Date(historyItem.timestamp).toLocaleDateString()}</p>
                                        </div>
                                    `;
                                }
                            });
                        }
                    }
                } else {
                    libraryContent.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-lock"></i>
                            <h3>Contenu Réservé aux Membres</h3>
                            <p>Connectez-vous pour accéder à votre bibliothèque personnelle.</p>
                            <button class="btn btn-primary" onclick="showAuthModal('login')">
                                <i class="fas fa-sign-in-alt"></i> Se connecter
                            </button>
                        </div>
                    `;
                }
            }
        }
        
        function switchLibraryTab(tab) {
            document.querySelectorAll('.library-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            document.querySelector(`.library-tab[data-tab="${tab}"]`).classList.add('active');
            document.getElementById(`${tab}Tab`).classList.add('active');
        }
        
        function toggleFavorite(itemId) {
            if (!currentUser) {
                showAuthModal('login');
                return;
            }
            
            const index = currentUser.favorites.indexOf(itemId);
            if (index > -1) {
                currentUser.favorites.splice(index, 1);
                showToast('Retiré des favoris', 'success');
            } else {
                currentUser.favorites.push(itemId);
                showToast('Ajouté aux favoris', 'success');
            }
            
            localStorage.setItem(AUTH_KEY, JSON.stringify(currentUser));
            
            const favoriteBtn = event.target.closest('.favorite-btn');
            if (favoriteBtn) {
                favoriteBtn.classList.toggle('active');
            }
        }
        
        function rateItem(itemId, rating) {
            if (!currentUser) {
                showAuthModal('login');
                return;
            }
            
            currentUser.ratings[itemId] = rating;
            localStorage.setItem(AUTH_KEY, JSON.stringify(currentUser));
            showToast(`Noté ${rating} étoile(s)`, 'success');
            
            const stars = event.target.parentElement.querySelectorAll('.fa-star');
            stars.forEach((star, index) => {
                star.classList.toggle('active', index < rating);
            });
        }
        
        function showPage(pageId) {
            const menu = document.getElementById('userMenu');
            if (menu) menu.classList.remove('active');
            
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            const page = document.getElementById(pageId);
            if (page) {
                page.classList.add('active');
                
                const navLink = document.querySelector(`[data-page="${pageId}"]`);
                if (navLink) {
                    navLink.classList.add('active');
                }
            }
            
            if (pageId === 'homePage') {
                renderList('booksList', data.books);
                renderList('mangaList', data.mangas);
                renderList('articlesList', data.articles);
            } else if (pageId === 'booksPage') {
                renderList('booksPageList', data.books);
            } else if (pageId === 'mangaPage') {
                renderList('mangaPageList', data.mangas);
            } else if (pageId === 'articlesPage') {
                renderList('articlesPageList', data.articles);
            } else if (pageId === 'libraryPage') {
                updateProtectedContent();
            }
        }
        
        // Navigation
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const pageId = link.dataset.page;
                
                if (pageId === 'libraryPage' && !currentUser) {
                    showAuthModal('login');
                    return;
                }
                
                showPage(pageId);
            });
        });
        
        document.querySelectorAll('.view-all').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                showPage(link.dataset.page);
            });
        });
        
        // Recherche
        document.getElementById('searchInput').addEventListener('input', function() {
            const query = this.value.toLowerCase().trim();
            
            if (query.length === 0) {
                showPage('homePage');
                return;
            }
            
            const allItems = [...data.books, ...data.mangas, ...data.articles];
            const results = allItems.filter(item => 
                item.title.toLowerCase().includes(query) ||
                item.author.toLowerCase().includes(query) ||
                item.genre.toLowerCase().includes(query)
            );
            
            const resultsContainer = document.getElementById('searchResults');
            if (resultsContainer) {
                if (results.length > 0) {
                    renderList('searchResults', results);
                } else {
                    resultsContainer.innerHTML = `
                        <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: var(--gray);">
                            <i class="fas fa-search" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.5;"></i>
                            <h3>Aucun résultat</h3>
                            <p>Aucun contenu ne correspond à votre recherche.</p>
                        </div>
                    `;
                }
                
                showPage('searchPage');
            }
        });
        
        // Carousel
        let currentSlide = 0;
        const slides = document.querySelectorAll('.hero-slide');
        const indicators = document.querySelectorAll('.indicator');
        
        function showSlide(index) {
            slides.forEach(slide => slide.classList.remove('active'));
            indicators.forEach(indicator => indicator.classList.remove('active'));
            
            currentSlide = index;
            slides[index].classList.add('active');
            indicators[index].classList.add('active');
        }
        
        function nextSlide() {
            currentSlide = (currentSlide + 1) % slides.length;
            showSlide(currentSlide);
        }
        
        function prevSlide() {
            currentSlide = (currentSlide - 1 + slides.length) % slides.length;
            showSlide(currentSlide);
        }
        
        document.querySelector('.carousel-control.next').addEventListener('click', nextSlide);
        document.querySelector('.carousel-control.prev').addEventListener('click', prevSlide);
        
        indicators.forEach((indicator, index) => {
            indicator.addEventListener('click', () => showSlide(index));
        });
        
        let carouselInterval = setInterval(nextSlide, 5000);
        
        document.querySelector('.hero-carousel').addEventListener('mouseenter', () => {
            clearInterval(carouselInterval);
        });
        
        document.querySelector('.hero-carousel').addEventListener('mouseleave', () => {
            carouselInterval = setInterval(nextSlide, 5000);
        });
        
        // Thème
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('muyambili_theme', newTheme);
            updateThemeIcon();
        }
        
        function updateThemeIcon() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const icons = document.querySelectorAll('#themeToggle i, #themeToggleMobile i');
            const labels = document.querySelectorAll('#themeToggle span');
            
            icons.forEach(icon => {
                icon.className = currentTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
            });
            
            labels.forEach(label => {
                label.textContent = currentTheme === 'dark' ? 'Mode clair' : 'Mode sombre';
            });
        }
        
        // Toast
        function showToast(message, type = 'success') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            const icons = {
                success: 'fas fa-check-circle',
                error: 'fas fa-exclamation-circle',
                warning: 'fas fa-exclamation-triangle'
            };
            
            toast.innerHTML = `
                <i class="${icons[type] || icons.success}"></i>
                <span>${message}</span>
            `;
            
            container.appendChild(toast);
            
            setTimeout(() => toast.classList.add('show'), 10);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }
        
        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                const splashScreen = document.getElementById('splashScreen');
                splashScreen.style.opacity = '0';
                setTimeout(() => {
                    splashScreen.style.display = 'none';
                }, 500);
            }, 1000);
            
            loadCurrentUser();
            
            const savedTheme = localStorage.getItem('muyambili_theme');
            if (savedTheme) {
                document.documentElement.setAttribute('data-theme', savedTheme);
            }
            updateThemeIcon();
            
            document.getElementById('themeToggle').addEventListener('click', toggleTheme);
            document.getElementById('themeToggleMobile').addEventListener('click', toggleTheme);
            
            document.getElementById('favoritesBtn').addEventListener('click', () => {
                if (currentUser) {
                    showPage('libraryPage');
                } else {
                    showAuthModal('login');
                }
            });
            
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    switchAuthTab(tab.dataset.tab);
                });
            });
            
            document.getElementById('contactForm').addEventListener('submit', function(e) {
                e.preventDefault();
                showToast('Message envoyé avec succès !', 'success');
                this.reset();
            });
            
            showPage('homePage');
            
            if (currentUser) {
                setTimeout(() => {
                    showToast(`Bon retour, ${currentUser.username} !`, 'success');
                }, 500);
            }
        });
    </script>
</body>
</html>
