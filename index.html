<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Lectio ‚Äî Lectures</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ====== RESET ====== */
* { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial; }
body { display: flex; height: 100vh; background:#f5f5f5; }

/* ===== SIDEBAR (DESKTOP) ===== */
.sidebar {
  width: 80px;
  background: #111;
  color: #fff;
  display: flex;
  flex-direction: column;
  padding-top: 20px;
  align-items: center;
}
.sidebar button {
  background: none;
  border: none;
  color: white;
  margin: 20px 0;
  font-size: 20px;
  cursor: pointer;
}

/* ===== BOTTOM BAR (MOBILE) ===== */
.bottombar {
  display:none;
  position: fixed;
  bottom: 0; left:0;
  width: 100%;
  background: #111;
  padding:10px 0;
  display:flex;
  justify-content: space-around;
}
.bottombar button {
  background:none;
  border:none;
  color:white;
  font-size:22px;
}

/* ===== MAIN ===== */
main { flex: 1; overflow-y: auto; }

/* ===== HEADER ===== */
header {
  background: #ffffff;
  padding: 20px;
  box-shadow:0 2px 5px rgba(0,0,0,0.1);
}
header h1 { margin-bottom: 10px; }

/* ===== SEARCH ===== */
#searchBar {
  width: 100%;
  padding: 12px;
  border: 2px solid #ddd;
  border-radius: 5px;
  margin-bottom:20px;
}

/* ===== CAROUSEL ===== */
#carousel {
  display: flex;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
}
.carousel-item {
  min-width: 300px;
  margin-right: 10px;
  scroll-snap-align: center;
}
.carousel-item img {
  width: 100%;
  border-radius: 10px;
}

/* ===== GRID ===== */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill,minmax(150px,1fr));
  gap: 20px;
  padding: 20px;
}
.item img {
  width:100%;
  border-radius: 10px;
}
.item-title { font-weight: bold; margin-top: 5px; }

/* ===== PAGES ===== */
.page { display:none; padding: 20px; }
.active { display:block; }

/* ===== DESCRIPTION ===== */
.description-cover {
  width: 200px;
  border-radius:10px;
}
.chapter-link {
  display:block;
  margin:10px 0;
  padding:10px;
  background:#ddd;
  border-radius:5px;
  cursor:pointer;
}

/* ===== COMMENTAIRES ===== */
textarea {
  width: 100%;
  padding:10px;
  margin-top:10px;
}
.comment {
  background:white;
  padding:10px;
  border-radius:5px;
  margin-top:10px;
  border-left:5px solid #333;
}

/* ===== MOBILE ===== */
@media(max-width:800px){
  .sidebar { display:none; }
  .bottombar { display:flex; }
  body { flex-direction: column; }
  main { flex:1; margin-bottom:70px; }
}
</style>
</head>

<body>

<!-- SIDEBAR DESKTOP -->
<div class="sidebar">
  <button onclick="showPage('home')">üè†</button>
  <button onclick="showPage('books')">üìö</button>
  <button onclick="showPage('manga')">üìñ</button>
  <button onclick="showPage('articles')">üì∞</button>
  <button onclick="showPage('account')">üë§</button>
</div>

<!-- BOTTOMBAR MOBILE -->
<div class="bottombar">
  <button onclick="showPage('home')">üè†</button>
  <button onclick="showPage('books')">üìö</button>
  <button onclick="showPage('manga')">üìñ</button>
  <button onclick="showPage('articles')">üì∞</button>
  <button onclick="showPage('account')">üë§</button>
</div>

<main>

<!-- =========== PAGE ACCUEIL =========== -->
<div id="home" class="page active">

<header>
  <h1>Lectio</h1>
  <input type="text" id="searchBar" placeholder="Rechercher un titre, un genre ou un auteur..." oninput="searchContent()">

  <!-- CAROUSEL -->
  <div id="carousel">
    <div class="carousel-item"><img src="https://images.unsplash.com/photo-1524995997946-a1c2e315a42f" /></div>
    <div class="carousel-item"><img src="https://images.unsplash.com/photo-1495446815901-a7297e633e8d" /></div>
    <div class="carousel-item"><img src="https://images.unsplash.com/photo-1496104679561-38d3af0ef3e8" /></div>
  </div>
</header>

<div id="searchResults" class="grid"></div>

</div>

<!-- =========== PAGE LIVRES =========== -->
<div id="books" class="page">
  <h2>Livres</h2>
  <div id="booksGrid" class="grid"></div>
</div>

<!-- =========== PAGE MANGA =========== -->
<div id="manga" class="page">
  <h2>Mangas</h2>
  <div id="mangaGrid" class="grid"></div>
</div>

<!-- =========== PAGE ARTICLES =========== -->
<div id="articles" class="page">
  <h2>Articles</h2>
  <div id="articlesGrid" class="grid"></div>
</div>

<!-- =========== PAGE DESCRIPTION =========== -->
<div id="description" class="page"></div>

<!-- =========== PAGE LECTURE =========== -->
<div id="reader" class="page">
  <h2 id="readerTitle"></h2>
  <iframe id="pdfViewer" style="width:100%;height:80vh;border:none;"></iframe>
  <p id="viewsCounter"></p>
</div>

<!-- =========== PAGE COMPTE =========== -->
<div id="account" class="page">
  <h2>Mon compte</h2>
  <h3>Historique de lecture</h3>
  <div id="history"></div>
</div>

</main>

<script>
/* ===========================================================
   BASE DE DONN√âES AVEC IMAGES R√âELLES + PDF R√âELS
=========================================================== */

const DUMMY_PDF = "https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf";

const books = [
  {
    id:"book1",
    type:"book",
    title:"Les Flammes du Destin",
    author:"A. Mavoko",
    genre:"Fantasy",
    cover:"https://images.unsplash.com/photo-1544933231-bd53f7f1cb3c",
    summary:"Une jeune guerri√®re d√©couvre un pouvoir ancestral capable de sauver ou d√©truire son royaume.",
    chapters:[
      { title:"Chapitre 1", file:DUMMY_PDF },
      { title:"Chapitre 2", file:DUMMY_PDF }
    ]
  },
  {
    id:"book2",
    type:"book",
    title:"L‚ÄôOmbre du Jaguar",
    author:"Michel N'Gouabi",
    genre:"Thriller",
    cover:"https://images.unsplash.com/photo-1528207622230-428e1f8a88e3",
    summary:"Un inspecteur poursuit un tueur en s√©rie √† Libreville.",
    chapters:[
      { title:"Chapitre 1", file:DUMMY_PDF }
    ]
  }
];

const mangas = [
  {
    id:"manga1",
    type:"manga",
    title:"Blade Runner X",
    author:"Takeshi Ryu",
    genre:"Action",
    cover:"https://images.unsplash.com/photo-1519681393784-d120267933ba",
    summary:"Un adolescent cybern√©tique tente d‚Äô√©chapper √† l'arm√©e.",
    chapters:[
      { title:"Chapitre 1", file:DUMMY_PDF },
      { title:"Chapitre 2", file:DUMMY_PDF }
    ]
  }
];

const articles = [
  {
    id:"article1",
    type:"article",
    title:"L‚ÄôIA en Afrique Centrale",
    author:"Jean-Claude M.",
    genre:"Technologie",
    cover:"https://images.unsplash.com/photo-1518770660439-4636190af475",
    summary:"Analyse de la mont√©e des startups IA.",
    chapters:[
      { title:"Article Complet", file:DUMMY_PDF }
    ]
  }
];

/* ===========================================================
   AFFICHAGE DES GRILLES
=========================================================== */

function loadGrids() {
  displayGrid("booksGrid", books);
  displayGrid("mangaGrid", mangas);
  displayGrid("articlesGrid", articles);
}

function displayGrid(container, array) {
  const div = document.getElementById(container);
  div.innerHTML = "";
  array.forEach(item=>{
    div.innerHTML += `
      <div class="item" onclick="openDescription('${item.type}','${item.id}')">
        <img src="${item.cover}">
        <div class="item-title">${item.title}</div>
      </div>
    `;
  });
}

/* ===========================================================
   NAVIGATION ENTRE LES PAGES
=========================================================== */
function showPage(id){
  document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

/* ===========================================================
   PAGE DESCRIPTION
=========================================================== */
function openDescription(type,id){
  showPage("description");
  const data = [...books,...mangas,...articles].find(x=>x.id===id);

  let chaptersHtml = "";
  data.chapters.forEach((c,i)=>{
    chaptersHtml += `
      <div class="chapter-link" onclick="openReader('${data.id}',${i})">
        ${c.title}
      </div>`;
  });

  document.getElementById("description").innerHTML = `
    <img class="description-cover" src="${data.cover}">
    <h2>${data.title}</h2>
    <p><strong>Auteur :</strong> ${data.author}</p>
    <p><strong>Genre :</strong> ${data.genre}</p>
    <p>${data.summary}</p>

    <h3>Chapitres :</h3>
    ${chaptersHtml}

    <h3>Commentaires :</h3>
    <div id="comments"></div>

    <textarea id="commentInput" placeholder="Votre commentaire..."></textarea>
    <button onclick="addComment('${data.id}')">Publier</button>
  `;

  loadComments(id);
}

/* ===========================================================
   COMMENTAIRES
=========================================================== */
function loadComments(id){
  const comments = JSON.parse(localStorage.getItem("comments_"+id) || "[]");
  const div = document.getElementById("comments");
  div.innerHTML = comments.map(c=>`<div class="comment">${c}</div>`).join("");
}

function addComment(id){
  const txt = document.getElementById("commentInput").value;
  if(!txt) return;

  const comments = JSON.parse(localStorage.getItem("comments_"+id) || "[]");
  comments.push(txt);
  localStorage.setItem("comments_"+id, JSON.stringify(comments));
  loadComments(id);

  document.getElementById("commentInput").value = "";
}

/* ===========================================================
   LECTEUR PDF + HISTORIQUE + VUES
=========================================================== */
function openReader(id,chapterIndex){
  showPage("reader");

  const data = [...books,...mangas,...articles].find(x=>x.id===id);
  const chapter = data.chapters[chapterIndex];

  document.getElementById("readerTitle").innerText = data.title+" ‚Äî "+chapter.title;
  document.getElementById("pdfViewer").src = chapter.file;

  // compteur de vues
  let views = Number(localStorage.getItem("views_"+id+"_"+chapterIndex) || 0);
  views++;
  localStorage.setItem("views_"+id+"_"+chapterIndex, views);
  document.getElementById("viewsCounter").innerText = views+" vues";

  // historique
  const hist = JSON.parse(localStorage.getItem("history") || "[]");
  hist.push({ title:data.title, chapter:chapter.title, date: new Date().toLocaleString() });
  localStorage.setItem("history", JSON.stringify(hist));

  loadHistory();
}

function loadHistory(){
  const hist = JSON.parse(localStorage.getItem("history") || "[]");
  const div = document.getElementById("account");
  let html = "<h2>Mon compte</h2><h3>Historique</h3>";
  hist.forEach(h=>{
    html += `<div>- ${h.title} ‚Äî ${h.chapter} (${h.date})</div>`;
  });
  div.innerHTML = html;
}

/* ===========================================================
   RECHERCHE
=========================================================== */
function searchContent(){
  const q = document.getElementById("searchBar").value.toLowerCase();
  const all = [...books,...mangas,...articles];
  const result = all.filter(x => x.title.toLowerCase().includes(q) || x.author.toLowerCase().includes(q) || x.genre.toLowerCase().includes(q));

  const div = document.getElementById("searchResults");
  div.innerHTML = "";
  result.forEach(item=>{
    div.innerHTML += `
      <div class="item" onclick="openDescription('${item.type}','${item.id}')">
        <img src="${item.cover}">
        <div class="item-title">${item.title}</div>
      </div>`;
  });
}

/* ===========================================================
   INIT
=========================================================== */
loadGrids();
loadHistory();

</script>

</body>
</html>
